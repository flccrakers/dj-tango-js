{"ast":null,"code":"import _objectSpread from \"/home/hoonakker/Dropbox/dvt/projet-JAVASCRIPT/react-tutos/dj-tango-js/IHM/node_modules/@babel/runtime/helpers/esm/objectSpread\";\nimport _classCallCheck from \"/home/hoonakker/Dropbox/dvt/projet-JAVASCRIPT/react-tutos/dj-tango-js/IHM/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/home/hoonakker/Dropbox/dvt/projet-JAVASCRIPT/react-tutos/dj-tango-js/IHM/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/home/hoonakker/Dropbox/dvt/projet-JAVASCRIPT/react-tutos/dj-tango-js/IHM/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/home/hoonakker/Dropbox/dvt/projet-JAVASCRIPT/react-tutos/dj-tango-js/IHM/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/home/hoonakker/Dropbox/dvt/projet-JAVASCRIPT/react-tutos/dj-tango-js/IHM/node_modules/@babel/runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"/home/hoonakker/Dropbox/dvt/projet-JAVASCRIPT/react-tutos/dj-tango-js/IHM/src/components/source-list.js\";\nimport React, { Component } from 'react';\nimport { connect } from 'react-redux';\nimport * as sourceActions from '../redux/actions/sourceActions';\nimport IconButton from '@material-ui/core/IconButton';\nimport VirtualList from 'react-tiny-virtual-list';\nimport DataLine from './data-line';\nimport { sortStatus as SORT } from '../services/dj-const';\nimport ArrowUp from '@material-ui/icons/ArrowUpward';\nimport ArrowDown from '@material-ui/icons/ArrowDownward';\nimport Shuffle from '@material-ui/icons/Shuffle';\nimport Refresh from '@material-ui/icons/Refresh';\nimport List from '@material-ui/core/List';\nimport ListItem from '@material-ui/core/ListItem';\nimport ListItemText from '@material-ui/core/ListItemText';\nimport Menu from '@material-ui/core/Menu';\nimport MenuItem from '@material-ui/core/MenuItem';\nimport Paper from '@material-ui/core/Paper';\nimport * as djUtils from './dj-utils';\nvar styles = {\n  leftAligned: {\n    textAlign: 'left'\n  },\n  center: {\n    textAlign: 'center'\n  },\n  ellipsis: {\n    whiteSpace: 'nowrap',\n    textOverflow: 'ellipsis',\n    overflow: 'hidden'\n  },\n  sourceScrolling: {\n    overflow: 'hidden',\n    overflowY: 'auto',\n    display: 'flex',\n    flex: '1 1 auto',\n    minHeight: '0px',\n    flexDirection: 'column'\n  },\n  mainSource: {\n    display: 'flex',\n    flexDirection: 'column',\n    flex: '1 1 50%',\n    margin: '3px 0px 0px 0px',\n    padding: '2px',\n    color: 'white',\n    // backgroundColor: 'blue',\n    border: '1pt solid ' + '#5f5f5f',\n    overflow: 'hidden'\n  },\n  virtualListContainer: {\n    flex: \"1\",\n    display: 'flex',\n    flexDirection: 'column'\n  },\n  filterButton: {\n    padding: '0px',\n    margin: '0px',\n    height: '24px'\n  },\n  icon: {\n    width: '24px',\n    height: '24px'\n  }\n};\nvar rowsTemplate = [{\n  name: '',\n  field: 'played',\n  size: 40,\n  align: 'center',\n  sortStatus: SORT.NONE\n}, {\n  name: 'Title',\n  field: 'title',\n  size: 'auto',\n  align: 'left',\n  sortStatus: SORT.NONE\n}, {\n  name: 'Artist',\n  field: 'artist',\n  size: 'auto',\n  align: 'left',\n  sortStatus: SORT.NONE\n}, {\n  name: 'Singer',\n  field: 'singer',\n  size: 'auto',\n  align: 'left',\n  sortStatus: SORT.NONE\n}, {\n  name: 'Album',\n  field: 'album',\n  size: 'auto',\n  align: 'left',\n  sortStatus: SORT.NONE\n}, {\n  name: 'Genre',\n  field: 'genre',\n  size: 100,\n  align: 'center',\n  sortStatus: SORT.ASC\n}, {\n  name: 'Year',\n  field: 'year',\n  size: 50,\n  align: 'center',\n  sortStatus: SORT.NONE\n}, {\n  name: 'Bpm',\n  field: 'bpmHuman',\n  size: 80,\n  align: 'center',\n  sortStatus: SORT.NONE\n}, {\n  name: 'Time',\n  field: 'duration',\n  size: 40,\n  align: 'center',\n  sortStatus: SORT.NONE\n}];\nvar filterTemplate = [{\n  name: 'Artist',\n  field: 'artist',\n  size: 'auto',\n  align: 'left',\n  sortStatus: SORT.NONE\n}, {\n  name: 'Singer',\n  field: 'singer',\n  size: 'auto',\n  align: 'left',\n  sortStatus: SORT.NONE\n}, {\n  name: 'Album',\n  field: 'album',\n  size: 'auto',\n  align: 'left',\n  sortStatus: SORT.NONE\n}, {\n  name: 'Genre',\n  field: 'genre',\n  size: 150,\n  align: 'center',\n  sortStatus: SORT.ASC\n}];\n\nvar SourceList =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(SourceList, _Component);\n\n  function SourceList(props) {\n    var _this;\n\n    _classCallCheck(this, SourceList);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(SourceList).call(this, props));\n\n    _this.handleShuffle = function () {\n      _this.props.dispatch(sourceActions.shuffleTangoList(_this.props.source.displayTangoList));\n    };\n\n    _this.handleMenuItemClick = function (event, index, field) {\n      // console.log(index, field,);\n      var _this$props$source = _this.props.source,\n          selectedIndex = _this$props$source.selectedIndex,\n          anchorEl = _this$props$source.anchorEl;\n      selectedIndex[field] = index;\n      anchorEl[field] = null;\n\n      _this.props.dispatch(sourceActions.updateFilter(anchorEl, selectedIndex));\n\n      _this.props.dispatch(sourceActions.filterTangoList(selectedIndex, _this.props.source.filterList, _this.props.source.tangoList, _this.props.source.sortingDatas));\n    };\n\n    _this.handleClose = function (field) {\n      // console.log(field + ' to close');\n      var anchorEl = _this.props.source.anchorEl;\n      anchorEl[field] = null;\n\n      _this.props.dispatch(sourceActions.updateAnchorState(anchorEl));\n    };\n\n    _this.updateTango = function (tango) {\n      console.log('should play ' + tango.path);\n    };\n\n    _this.rowRenderer = function (params) {\n      var sizedRows = djUtils.getSizedRows(rowsTemplate, _this.state.containerWidth);\n      var tango = _this.props.source.displayTangoList[params.index];\n      return React.createElement(DataLine, {\n        tango: tango,\n        sizedRows: sizedRows,\n        rowHeight: _this.props.source.listRowHeight,\n        style: params.style,\n        index: params.index,\n        key: tango._id,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 417\n        },\n        __self: this\n      });\n    };\n\n    _this._noRowsRenderer = function () {\n      return React.createElement(\"span\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 430\n        },\n        __self: this\n      }, \"NOTHING\");\n    };\n\n    _this.state = {\n      containerHeight: 600,\n      containerWidth: 600\n    };\n    return _this;\n  }\n\n  _createClass(SourceList, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      this.updateDimensions();\n      window.addEventListener(\"resize\", this.updateDimensions.bind(this));\n    }\n  }, {\n    key: \"componentWillUnmount\",\n    value: function componentWillUnmount() {\n      window.removeEventListener(\"resize\", this.updateDimensions);\n    }\n  }, {\n    key: \"updateDimensions\",\n    value: function updateDimensions() {\n      var containerHeight = this.refs.virtualContainer.clientHeight;\n      var containerWidth = this.refs.virtualContainer.clientWidth;\n      this.setState({\n        containerHeight: containerHeight,\n        containerWidth: containerWidth\n      });\n    }\n  }, {\n    key: \"componentWillReceiveProps\",\n    value: function componentWillReceiveProps(newProps) {// console.log(newProps);\n\n      /*if (this.props.tangoList.length === 0) {\n        this.props.dispatch(sourceActions.fetchAllTangos());\n      }*/\n    }\n  }, {\n    key: \"handleClickListItem\",\n    value: function handleClickListItem(field, event) {\n      console.log(field);\n      var anchorEl = this.props.source.anchorEl;\n      anchorEl[field] = event.currentTarget;\n      this.setState({\n        anchorEl: anchorEl\n      });\n    }\n  }, {\n    key: \"getFilterContent\",\n    value: function getFilterContent(sizedRows) {\n      var _this2 = this;\n\n      var ret = [];\n\n      var left = _objectSpread({}, styles.leftAligned, {\n        padding: '0px 2px 0px 2px',\n        WebkitUserSelect: 'none'\n      });\n\n      var center = _objectSpread({}, styles.center, {\n        padding: '0px 2px 0px 2px',\n        WebkitUserSelect: 'none'\n      });\n\n      var titleContainer = {\n        display: 'flex',\n        width: '100%',\n        alignItems: 'center',\n        cursor: 'pointer'\n      };\n      var optionsList = this.props.source.filterList;\n      var anchorEl = this.props.source.anchorEl;\n\n      if (optionsList !== null) {\n        sizedRows.forEach(function (row) {\n          var style = {\n            height: '24px'\n          }; // if (row.align === 'left') {\n          //   style = {...left, width: row.size, height: '24px'};\n          // } else if (row.align === 'center') {\n          //   style = {...center, width: row.size, height: '24px'};\n          // }\n          // console.log(row.name);\n\n          if (row.name !== '') {\n            // console.log(optionsList[row.field]);\n            ret.push(React.createElement(\"div\", {\n              key: 'filter_' + row.name,\n              style: style,\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 253\n              },\n              __self: this\n            }, React.createElement(List, {\n              style: styles.filterButton,\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 254\n              },\n              __self: this\n            }, React.createElement(ListItem, {\n              button: true,\n              \"aria-haspopup\": \"true\",\n              \"aria-controls\": \"lock-menu\",\n              \"aria-label\": \"When device is locked\",\n              onClick: _this2.handleClickListItem.bind(_this2, row.field),\n              style: styles.filterButton,\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 255\n              },\n              __self: this\n            }, React.createElement(ListItemText, {\n              primary: optionsList[row.field][_this2.props.source.selectedIndex[row.field]] || '',\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 263\n              },\n              __self: this\n            }))), React.createElement(Menu, {\n              id: \"lock-menu\" + row.name,\n              anchorEl: anchorEl[row.field],\n              open: Boolean(anchorEl[row.field]),\n              onClose: _this2.handleClose.bind(_this2, row.field) // classes={styles.filterButton}\n              ,\n              styles: styles.filterButton,\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 268\n              },\n              __self: this\n            }, optionsList[row.field].map(function (option, index) {\n              return React.createElement(MenuItem, {\n                key: option,\n                selected: index === _this2.props.source.selectedIndex[row.field],\n                onClick: function onClick(event) {\n                  return _this2.handleMenuItemClick(event, index, row.field);\n                },\n                __source: {\n                  fileName: _jsxFileName,\n                  lineNumber: 278\n                },\n                __self: this\n              }, option);\n            }))));\n          } else {\n            ret.push(React.createElement(\"th\", {\n              key: 'filter_' + row.name,\n              style: style,\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 292\n              },\n              __self: this\n            }, React.createElement(\"div\", {\n              style: titleContainer,\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 293\n              },\n              __self: this\n            })));\n          }\n        });\n      }\n\n      return React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 301\n        },\n        __self: this\n      }, ret);\n    }\n  }, {\n    key: \"getHeaderContent\",\n    value: function getHeaderContent(sizedRows) {\n      var _this3 = this;\n\n      var ret = [];\n\n      var left = _objectSpread({}, styles.leftAligned, {\n        padding: '0px 2px 5px 2px',\n        WebkitUserSelect: 'none'\n      });\n\n      var center = _objectSpread({}, styles.center, {\n        padding: '0px 2px 5px 2px',\n        WebkitUserSelect: 'none'\n      });\n\n      var titleContainer = {\n        display: 'flex',\n        width: '100%',\n        alignItems: 'center',\n        cursor: 'pointer'\n      };\n      var sortingDatas = this.props.source.sortingDatas;\n      sizedRows.forEach(function (row) {\n        var style;\n\n        if (row.align === 'left') {\n          style = _objectSpread({}, left, {\n            width: row.size,\n            height: '24px'\n          });\n        } else if (row.align === 'center') {\n          style = _objectSpread({}, center, {\n            width: row.size,\n            height: '24px'\n          });\n        }\n\n        var sort = [];\n\n        if (row.field === sortingDatas.sortingField) {\n          if (sortingDatas.sortingDirection === SORT.ASC) {\n            sort = [React.createElement(ArrowUp, {\n              style: {\n                color: 'white'\n              },\n              key: 'sortUp',\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 329\n              },\n              __self: this\n            })];\n          } else if (sortingDatas.sortingDirection === SORT.DESC) {\n            sort = [React.createElement(ArrowDown, {\n              style: {\n                color: 'white'\n              },\n              key: 'sortDown',\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 331\n              },\n              __self: this\n            })];\n          }\n        }\n\n        ret.push(React.createElement(\"th\", {\n          key: 'header_' + row.name,\n          style: style,\n          onClick: function onClick(event) {\n            _this3.handleTitleClick(event, row.field);\n          },\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 336\n          },\n          __self: this\n        }, React.createElement(\"div\", {\n          style: titleContainer,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 339\n          },\n          __self: this\n        }, row.name, sort)));\n      });\n      return ret;\n    }\n  }, {\n    key: \"getFilter\",\n    value: function getFilter() {\n      var _this4 = this;\n\n      var sizedRows = djUtils.getSizedRows(filterTemplate, this.state.containerWidth - 100);\n      var styles = {\n        paperContainer: {\n          display: 'flex',\n          alignItems: 'center',\n          margin: '0px 2px 5px 2px'\n        },\n        button: {\n          height: '36px',\n          padding: '0 12px'\n        }\n      };\n      return [React.createElement(Paper, {\n        style: styles.paperContainer,\n        elevation: 4,\n        key: 'filter_source_menu',\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 364\n        },\n        __self: this\n      }, React.createElement(IconButton, {\n        style: styles.button,\n        color: 'secondary',\n        onClick: this.handleShuffle,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 365\n        },\n        __self: this\n      }, React.createElement(Shuffle, {\n        style: styles.icon,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 370\n        },\n        __self: this\n      })), React.createElement(IconButton, {\n        style: styles.button,\n        color: 'secondary',\n        onClick: function onClick() {\n          _this4.props.dispatch(sourceActions.clearFilter(_this4.props.source.filterList, _this4.props.source.tangoList, _this4.props.source.sortingDatas));\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 372\n        },\n        __self: this\n      }, React.createElement(Refresh, {\n        style: styles.icon,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 379\n        },\n        __self: this\n      })), this.getFilterContent(sizedRows))];\n    }\n  }, {\n    key: \"getHeader\",\n    value: function getHeader() {\n      var sizedRows = djUtils.getSizedRows(rowsTemplate, this.state.containerWidth); // console.log(sizedRows);\n\n      var table = {\n        borderBottom: '1px solid red',\n        marginBottom: '15px'\n      };\n      return [React.createElement(\"table\", {\n        key: 'tableSourceTitle',\n        style: table,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 394\n        },\n        __self: this\n      }, React.createElement(\"thead\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 395\n        },\n        __self: this\n      }, React.createElement(\"tr\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 396\n        },\n        __self: this\n      }, this.getHeaderContent(sizedRows))))];\n    }\n  }, {\n    key: \"selectedRow\",\n    value: function selectedRow(id, selected) {\n      console.log(selected.Target); // console.log(selected.get());\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this5 = this;\n\n      var source = this.props.source;\n      return React.createElement(\"div\", {\n        style: styles.mainSource,\n        id: \"sources\",\n        ref: 'sources',\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 438\n        },\n        __self: this\n      }, this.getFilter(), this.getHeader(), React.createElement(\"div\", {\n        style: styles.virtualListContainer,\n        ref: 'virtualContainer',\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 441\n        },\n        __self: this\n      }, React.createElement(VirtualList, {\n        width: \"100%\",\n        height: this.state.containerHeight + source.listRowHeight,\n        itemCount: source.displayTangoList.length,\n        itemSize: source.listRowHeight // Also supports variable heights (array or function getter)\n        ,\n        renderItem: function renderItem(index, style) {\n          return _this5.rowRenderer(index);\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 442\n        },\n        __self: this\n      })));\n    }\n  }, {\n    key: \"handleTitleClick\",\n    value: function handleTitleClick(event, field) {\n      event.preventDefault();\n      this.updateTitleStatus(field);\n    }\n  }, {\n    key: \"updateTitleStatus\",\n    value: function updateTitleStatus(newField) {\n      var field = this.props.source.sortingDatas.sortingField;\n      var status = this.props.source.sortingDatas.sortingDirection;\n\n      if (newField !== field) {\n        status = SORT.NONE;\n      }\n\n      this.props.dispatch(sourceActions.updateSortStatusAndSort(newField, status, this.props.source.displayTangoList));\n    }\n  }]);\n\n  return SourceList;\n}(Component);\n\nexport default connect(function (store) {\n  return {\n    // tangoList: store.source.tangoList,\n    source: store.source\n  };\n})(SourceList);","map":{"version":3,"sources":["/home/hoonakker/Dropbox/dvt/projet-JAVASCRIPT/react-tutos/dj-tango-js/IHM/src/components/source-list.js"],"names":["React","Component","connect","sourceActions","IconButton","VirtualList","DataLine","sortStatus","SORT","ArrowUp","ArrowDown","Shuffle","Refresh","List","ListItem","ListItemText","Menu","MenuItem","Paper","djUtils","styles","leftAligned","textAlign","center","ellipsis","whiteSpace","textOverflow","overflow","sourceScrolling","overflowY","display","flex","minHeight","flexDirection","mainSource","margin","padding","color","border","virtualListContainer","filterButton","height","icon","width","rowsTemplate","name","field","size","align","NONE","ASC","filterTemplate","SourceList","props","handleShuffle","dispatch","shuffleTangoList","source","displayTangoList","handleMenuItemClick","event","index","selectedIndex","anchorEl","updateFilter","filterTangoList","filterList","tangoList","sortingDatas","handleClose","updateAnchorState","updateTango","tango","console","log","path","rowRenderer","params","sizedRows","getSizedRows","state","containerWidth","listRowHeight","style","_id","_noRowsRenderer","containerHeight","updateDimensions","window","addEventListener","bind","removeEventListener","refs","virtualContainer","clientHeight","clientWidth","setState","newProps","currentTarget","ret","left","WebkitUserSelect","titleContainer","alignItems","cursor","optionsList","forEach","row","push","handleClickListItem","Boolean","map","option","sort","sortingField","sortingDirection","DESC","handleTitleClick","paperContainer","button","clearFilter","getFilterContent","table","borderBottom","marginBottom","getHeaderContent","id","selected","Target","getFilter","getHeader","length","preventDefault","updateTitleStatus","newField","status","updateSortStatusAndSort","store"],"mappings":"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","sourcesContent":["import React, {Component} from 'react';\nimport {connect} from 'react-redux';\nimport * as sourceActions from '../redux/actions/sourceActions';\nimport IconButton from '@material-ui/core/IconButton';\nimport VirtualList from 'react-tiny-virtual-list';\nimport DataLine from './data-line';\nimport {sortStatus as SORT} from '../services/dj-const';\nimport ArrowUp from '@material-ui/icons/ArrowUpward';\nimport ArrowDown from '@material-ui/icons/ArrowDownward';\nimport Shuffle from '@material-ui/icons/Shuffle';\nimport Refresh from '@material-ui/icons/Refresh';\nimport List from '@material-ui/core/List';\nimport ListItem from '@material-ui/core/ListItem';\nimport ListItemText from '@material-ui/core/ListItemText';\nimport Menu from '@material-ui/core/Menu';\nimport MenuItem from '@material-ui/core/MenuItem'\nimport Paper from '@material-ui/core/Paper';\nimport * as djUtils from './dj-utils';\n\nconst styles = {\n  leftAligned: {\n    textAlign: 'left',\n  },\n  center: {\n    textAlign: 'center',\n  },\n  ellipsis: {\n    whiteSpace: 'nowrap',\n    textOverflow: 'ellipsis',\n    overflow: 'hidden',\n  },\n  sourceScrolling: {\n    overflow: 'hidden',\n    overflowY: 'auto',\n    display: 'flex',\n    flex: '1 1 auto',\n    minHeight: '0px',\n    flexDirection: 'column',\n  },\n  mainSource: {\n    display: 'flex',\n    flexDirection: 'column',\n    flex: '1 1 50%',\n    margin: '3px 0px 0px 0px',\n    padding: '2px',\n    color: 'white',\n    // backgroundColor: 'blue',\n    border: '1pt solid ' + '#5f5f5f',\n    overflow: 'hidden',\n  },\n  virtualListContainer: {\n    flex: \"1\",\n    display: 'flex',\n    flexDirection: 'column',\n  },\n  filterButton: {\n    padding: '0px',\n    margin: '0px',\n    height: '24px',\n  },\n  icon: {\n    width: '24px',\n    height: '24px',\n  },\n};\n\nconst rowsTemplate = [\n  {\n    name: '',\n    field: 'played',\n    size: 40,\n    align: 'center',\n    sortStatus: SORT.NONE,\n  },\n  {\n    name: 'Title',\n    field: 'title',\n    size: 'auto',\n    align: 'left',\n    sortStatus: SORT.NONE,\n  },\n  {\n    name: 'Artist',\n    field: 'artist',\n    size: 'auto',\n    align: 'left',\n    sortStatus: SORT.NONE,\n  },\n  {\n    name: 'Singer',\n    field: 'singer',\n    size: 'auto',\n    align: 'left',\n    sortStatus: SORT.NONE,\n  },\n  {\n    name: 'Album',\n    field: 'album',\n    size: 'auto',\n    align: 'left',\n    sortStatus: SORT.NONE,\n  },\n  {\n    name: 'Genre',\n    field: 'genre',\n    size: 100,\n    align: 'center',\n    sortStatus: SORT.ASC,\n  },\n  {\n    name: 'Year',\n    field: 'year',\n    size: 50,\n    align: 'center',\n    sortStatus: SORT.NONE,\n  },\n  {\n    name: 'Bpm',\n    field: 'bpmHuman',\n    size: 80,\n    align: 'center',\n    sortStatus: SORT.NONE,\n  },\n  {\n    name: 'Time',\n    field: 'duration',\n    size: 40,\n    align: 'center',\n    sortStatus: SORT.NONE,\n  }\n];\n\nconst filterTemplate = [\n  {\n    name: 'Artist',\n    field: 'artist',\n    size: 'auto',\n    align: 'left',\n    sortStatus: SORT.NONE,\n  },\n  {\n    name: 'Singer',\n    field: 'singer',\n    size: 'auto',\n    align: 'left',\n    sortStatus: SORT.NONE,\n  },\n  {\n    name: 'Album',\n    field: 'album',\n    size: 'auto',\n    align: 'left',\n    sortStatus: SORT.NONE,\n  },\n  {\n    name: 'Genre',\n    field: 'genre',\n    size: 150,\n    align: 'center',\n    sortStatus: SORT.ASC,\n  },\n];\n\n\nclass SourceList extends Component {\n\n  handleShuffle = () => {\n    this.props.dispatch(sourceActions.shuffleTangoList(this.props.source.displayTangoList))\n  };\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      containerHeight: 600,\n      containerWidth: 600,\n    };\n\n  }\n\n\n  componentDidMount() {\n    this.updateDimensions();\n    window.addEventListener(\"resize\", this.updateDimensions.bind(this));\n\n  }\n\n  componentWillUnmount() {\n    window.removeEventListener(\"resize\", this.updateDimensions);\n  }\n\n  updateDimensions() {\n    const containerHeight = this.refs.virtualContainer.clientHeight;\n    const containerWidth = this.refs.virtualContainer.clientWidth;\n    this.setState({containerHeight, containerWidth});\n  }\n\n  componentWillReceiveProps(newProps) {\n    // console.log(newProps);\n    /*if (this.props.tangoList.length === 0) {\n      this.props.dispatch(sourceActions.fetchAllTangos());\n    }*/\n\n  }\n\n  handleClickListItem(field, event) {\n    console.log(field);\n    let anchorEl = this.props.source.anchorEl;\n    anchorEl[field] = event.currentTarget;\n    this.setState({anchorEl});\n  }\n\n  handleMenuItemClick = (event, index, field) => {\n    // console.log(index, field,);\n    let {selectedIndex, anchorEl} = this.props.source;\n    selectedIndex[field] = index;\n    anchorEl[field] = null;\n    this.props.dispatch(sourceActions.updateFilter(anchorEl, selectedIndex));\n    this.props.dispatch(sourceActions.filterTangoList(selectedIndex, this.props.source.filterList, this.props.source.tangoList, this.props.source.sortingDatas))\n  };\n\n  handleClose = (field) => {\n    // console.log(field + ' to close');\n    let anchorEl = this.props.source.anchorEl;\n    anchorEl[field] = null;\n    this.props.dispatch(sourceActions.updateAnchorState(anchorEl));\n  };\n\n\n  getFilterContent(sizedRows) {\n    let ret = [];\n    let left = {...styles.leftAligned, padding: '0px 2px 0px 2px', WebkitUserSelect: 'none'};\n    let center = {...styles.center, padding: '0px 2px 0px 2px', WebkitUserSelect: 'none'};\n    let titleContainer = {\n      display: 'flex',\n      width: '100%',\n      alignItems: 'center',\n      cursor: 'pointer',\n    };\n    let optionsList = this.props.source.filterList;\n    const anchorEl = this.props.source.anchorEl;\n    if (optionsList !== null) {\n      sizedRows.forEach(row => {\n        let style = {height: '24px'};\n        // if (row.align === 'left') {\n        //   style = {...left, width: row.size, height: '24px'};\n        // } else if (row.align === 'center') {\n        //   style = {...center, width: row.size, height: '24px'};\n        // }\n        // console.log(row.name);\n        if (row.name !== '') {\n          // console.log(optionsList[row.field]);\n          ret.push(\n            <div key={'filter_' + row.name} style={style}>\n              <List style={styles.filterButton}>\n                <ListItem\n                  button\n                  aria-haspopup=\"true\"\n                  aria-controls=\"lock-menu\"\n                  aria-label=\"When device is locked\"\n                  onClick={this.handleClickListItem.bind(this, row.field)}\n                  style={styles.filterButton}\n                >\n                  <ListItemText\n                    primary={optionsList[row.field][this.props.source.selectedIndex[row.field]] || ''}\n                  />\n                </ListItem>\n              </List>\n              <Menu\n                id={\"lock-menu\" + row.name}\n                anchorEl={anchorEl[row.field]}\n                open={Boolean(anchorEl[row.field])}\n                onClose={this.handleClose.bind(this, row.field)}\n                // classes={styles.filterButton}\n                styles={styles.filterButton}\n              >\n                {optionsList[row.field].map((option, index) => {\n                  return (\n                    <MenuItem\n                      key={option}\n                      selected={index === this.props.source.selectedIndex[row.field]}\n                      onClick={event => this.handleMenuItemClick(event, index, row.field)}\n                    >\n                      {option}\n                    </MenuItem>\n                  )\n                })}\n              </Menu>\n            </div>\n          );\n        } else {\n          ret.push(\n            <th key={'filter_' + row.name} style={style}>\n              <div style={titleContainer}>\n              </div>\n            </th>\n          );\n        }\n      });\n    }\n    return (\n      <div>\n        {ret}\n      </div>\n    );\n\n  }\n\n  getHeaderContent(sizedRows) {\n    let ret = [];\n    let left = {...styles.leftAligned, padding: '0px 2px 5px 2px', WebkitUserSelect: 'none'};\n    let center = {...styles.center, padding: '0px 2px 5px 2px', WebkitUserSelect: 'none'};\n    let titleContainer = {\n      display: 'flex',\n      width: '100%',\n      alignItems: 'center',\n      cursor: 'pointer',\n    };\n    let sortingDatas = this.props.source.sortingDatas;\n    sizedRows.forEach(row => {\n      let style;\n      if (row.align === 'left') {\n        style = {...left, width: row.size, height: '24px'};\n      } else if (row.align === 'center') {\n        style = {...center, width: row.size, height: '24px'};\n      }\n      let sort = [];\n      if (row.field === sortingDatas.sortingField) {\n        if (sortingDatas.sortingDirection === SORT.ASC) {\n          sort = [<ArrowUp style={{color: 'white'}} key={'sortUp'}/>];\n        } else if (sortingDatas.sortingDirection === SORT.DESC) {\n          sort = [<ArrowDown style={{color: 'white'}} key={'sortDown'}/>];\n        }\n      }\n\n      ret.push(\n        <th key={'header_' + row.name} style={style} onClick={(event) => {\n          this.handleTitleClick(event, row.field)\n        }}>\n          <div style={titleContainer}>\n            {row.name}{sort}\n          </div>\n        </th>\n      );\n    });\n    return ret;\n\n  }\n\n  getFilter() {\n    let sizedRows = djUtils.getSizedRows(filterTemplate, this.state.containerWidth - 100);\n\n    const styles = {\n      paperContainer: {\n        display: 'flex',\n        alignItems: 'center',\n        margin: '0px 2px 5px 2px',\n      },\n      button: {\n        height: '36px',\n        padding: '0 12px',\n      }\n    };\n    return [\n      <Paper style={styles.paperContainer} elevation={4} key={'filter_source_menu'}>\n        <IconButton\n          style={styles.button}\n          color={'secondary'}\n          onClick={this.handleShuffle}\n        >\n          <Shuffle style={styles.icon}/>\n        </IconButton>\n        <IconButton\n          style={styles.button}\n          color={'secondary'}\n          onClick={() => {\n            this.props.dispatch(sourceActions.clearFilter(this.props.source.filterList, this.props.source.tangoList, this.props.source.sortingDatas))\n          }}\n        >\n          <Refresh style={styles.icon}/>\n        </IconButton>\n        {this.getFilterContent(sizedRows)}\n      </Paper>\n    ];\n  }\n\n  getHeader() {\n    let sizedRows = djUtils.getSizedRows(rowsTemplate, this.state.containerWidth);\n    // console.log(sizedRows);\n    const table = {\n      borderBottom: '1px solid red',\n      marginBottom: '15px',\n    };\n    return [\n      <table key={'tableSourceTitle'} style={table}>\n        <thead>\n        <tr>\n          {this.getHeaderContent(sizedRows)}\n        </tr>\n        </thead>\n      </table>\n    ];\n  }\n\n  selectedRow(id, selected) {\n    console.log(selected.Target);\n    // console.log(selected.get());\n  }\n\n  updateTango = (tango) => {\n    console.log('should play ' + tango.path);\n  };\n\n  rowRenderer = (params) => {\n    let sizedRows = djUtils.getSizedRows(rowsTemplate, this.state.containerWidth);\n    let tango = this.props.source.displayTangoList[params.index];\n    return (\n      <DataLine\n        tango={tango}\n        sizedRows={sizedRows}\n        rowHeight={this.props.source.listRowHeight}\n        style={params.style}\n        index={params.index}\n        key={tango._id}\n      />\n    );\n  };\n\n\n  _noRowsRenderer = () => {\n    return (<span>NOTHING</span>);\n  };\n\n\n  render() {\n\n    let source: sourceReducer = this.props.source;\n    return (\n      <div style={styles.mainSource} id='sources' ref={'sources'}>\n        {this.getFilter()}\n        {this.getHeader()}\n        <div style={styles.virtualListContainer} ref={'virtualContainer'}>\n          <VirtualList\n            width='100%'\n            height={this.state.containerHeight + source.listRowHeight}\n            itemCount={source.displayTangoList.length}\n            itemSize={source.listRowHeight} // Also supports variable heights (array or function getter)\n            renderItem={(index, style) => {\n              return (this.rowRenderer(index))\n            }}\n          />\n\n        </div>\n      </div>\n    );\n  }\n\n\n  handleTitleClick(event, field) {\n    event.preventDefault();\n    this.updateTitleStatus(field);\n\n  }\n\n  updateTitleStatus(newField) {\n    let field = this.props.source.sortingDatas.sortingField;\n    let status = this.props.source.sortingDatas.sortingDirection;\n    if (newField !== field) {\n      status = SORT.NONE;\n    }\n    this.props.dispatch(sourceActions.updateSortStatusAndSort(newField, status, this.props.source.displayTangoList));\n  }\n\n}\n\n\nexport default connect((store) => {\n  return {\n    // tangoList: store.source.tangoList,\n    source: store.source,\n  }\n\n})(SourceList);\n\n\n"]},"metadata":{},"sourceType":"module"}